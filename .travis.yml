language: c
sudo: false
env:
  matrix:
  - CONDA_PY=3.4
  - CONDA_PY=3.5
branches:
  only:
  - master
install:
- source devtools/travis-ci/install_miniconda.sh
- conda config --add channels omnia
- conda config --add channels astropy
- conda install -yq python-coveralls
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sleep 3
script:
- conda build --quiet devtools/conda-recipe
- devtools/travis-ci/build_docs.sh
after_success:
- cp $HOME/miniconda3/conda-bld/test-tmp_dir/.coverage .
- coveralls
deploy:
  - provider: s3
    access_key_id:
      secure: "Ybqq6fjpT4dJ64cV8mixkv5CP/oSTUUgmSiK5Rt3b6xYND0LWZggDhXV+d55kOrNUuNn4N1zOGKDnR52IEmKPl5uISOg1d7KJm3SnojhT6afJY3wtdEYEOnjA/47cwlFJVwNmxSlSwKLrXfGBNOH4p6OP9WG0kgy8GZ8bwwVbRJjyo+dpSqushJP7eFfAo+qhxJm4N4kGO4L82eNLHo2HZ5OjtL4kpCuuzbp6nKipOfxyzb55aQJ5LsK/hG4E3RUR4N+WkOlr7wpOsGGh5i/JPT2laJ4lrKd/X4xON2QM8OVcthWjRF3P5LTBGncKbHIZRAlUEvRNK9oMHMW052wKbskjZ9t1qJa6dgWaECt09Z1K2LbEkDdMNinB9P1faO4FunM2zCqxXlIcgf9hwLNDiBC9OZZEmVUOB5SSy96t6pUSvYj5q7DTJH/Wf7e3pLkbfbNC7oTmGK6S7av6FrQcoclfMRPELpZdl0pNqKfAxTVy7hzYr0spLj/J0zDqPpPs9IkvoQlkLDjH6N5etoi7b4//6B+7IHw3bfo3MOi0V96he+P3cFwpUSkFSaXZ/cm0HeXE8dVVYVRD6CXH6OjXlf4UCSIG4ZMjATYeYezcyhRnmv4AxsnxvWV9LuxORJ32LJfnlQGOJsL2tHfZ9zXznODNKtnsSXlYpfoaheXFwQ="
    secret_access_key:
      secure: "MApyWsFFwI0Vkz4hVwJGnwS2cGSlN6wryIiRQgzmZnfh2qcwRxh7vf9ctQqpiI+SxZhpD4Jhg4BOakB955k8SembK0wisRcWfVH0KWXcNQaCIfKH5jyxv6E3IEoG5TXMCwlmaRruWTdxVASZsLRES2rgpU6+9J2kDqnz6UUHMmzbJU4mdDVIJvsjRm8jetyVJjn3dDvMnbTcr47v8yZbJNgu5ri4mEF3U6eCcw2/HuxuJkmUMZ3lna5GFuQxw5ISKWzPbrWJBiTgeB8XlxT/QFI/3X1lrdUt/AxQC6nWyb0eQeomf0N6rezsuevxFHlDiwjnMNJYxLNHvJbm3c4f15Xh17yeFRj7OxqBlcYrpnvpoLjiiJb/YqLHfrSsd2S5FwxtyQBt6nnMVkze08WRdIPJeI1tmXznB8emz/nvHpA5dbkcyTKUu7wQ4wuMBFe/8yxuAH3uQz226eueJBvKYLHEWalc5HeSgw7c7C40YCNTdcoCwXmMaMhaN5u4Xa8Ru8rlcAOl2Jnv0piqZU4BywibiMnyiz95N0pkdzebGjdxTXARpR5CJDrcpjFb7ZV4lgFlj2YK76/9pJDVKuo/Mf9J6j23JRYNt76yUJUdPFsaCBCi+rvEr1OcR1mb7bsfvJBhbSQEzeG1AqFbwafkKpko7W9mcGkfn8kS04GnLuo="
    bucket: "msmbuilder.org"
    upload-dir: msmexplorer
    skip_cleanup: true
    local-dir: docs/_deploy/
    on:
      branch: master
      condition: "$CONDA_PY = 3.5"
    region: us-east-1
    detect_encoding: true
